# åº§ä½é¢„çº¦ç³»ç»Ÿ Selenium V2 - è¯¦ç»†å¼€å‘è®¡åˆ’

## ğŸ“‹ é¡¹ç›®ä¿¡æ¯

- **é¡¹ç›®åç§°**: seat_reservation_selenium_v2
- **å¼€å‘ç›®çš„**: è§£å†³æ»‘å—éªŒè¯ç é—®é¢˜ï¼Œé‡æ„åŸæœ‰æ··ä¹±ä»£ç 
- **å¼€å‘æ—¶é—´**: é¢„è®¡2-3å¤©
- **ç‰ˆæœ¬**: 2.0.0

---

## ğŸ¯ æ ¸å¿ƒéœ€æ±‚

### 1. åŠŸèƒ½éœ€æ±‚
- âœ… æ”¯æŒåŒè´¦æˆ·å¹¶è¡Œé¢„çº¦
- âœ… è‡ªåŠ¨è¯†åˆ«å¹¶å¤„ç†æ»‘å—éªŒè¯ç 
- âœ… é›†æˆHTTPç‰ˆæœ¬çš„åº§ä½åˆ—è¡¨æŸ¥è¯¢æœºåˆ¶
- âœ… è‡ªåŠ¨é€‰æ‹©æ˜å¤©çš„å¯é¢„çº¦æ—¥æœŸ
- âœ… æ”¯æŒè‡ªå®šä¹‰åº§ä½å·ï¼ˆé¦–é€‰158ã€159ï¼‰

### 2. æŠ€æœ¯éœ€æ±‚
- âœ… ä½¿ç”¨Selenium + Edgeæµè§ˆå™¨
- âœ… ä½¿ç”¨webdriver-managerè‡ªåŠ¨ç®¡ç†é©±åŠ¨ï¼ˆè§£å†³ç‰ˆæœ¬æ›´æ–°é—®é¢˜ï¼‰
- âœ… ä½¿ç”¨ddddocrè¯†åˆ«æ»‘å—è·ç¦»
- âœ… ä¸¥æ ¼éµå®ˆPEP8ä»£ç è§„èŒƒ
- âœ… ä¸­æ–‡æ³¨é‡Šï¼Œä»£ç æ˜“è¯»
- âœ… æ¨¡å—åŒ–è®¾è®¡ï¼ŒèŒè´£æ¸…æ™°

### 3. æ€§èƒ½éœ€æ±‚
- âœ… ä»…è®°å½•å¤±è´¥æ—¥å¿—ï¼Œå‡å°‘IOå¼€é”€
- âœ… åŒè´¦æˆ·çœŸæ­£å¹¶è¡Œæ‰§è¡Œ
- âœ… éªŒè¯ç è¯†åˆ«å‡†ç¡®ç‡ > 95%

---

## ğŸ—ï¸ æœ€ç»ˆé¡¹ç›®æ¶æ„

```
seat_reservation_selenium_v2/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py                 âœ… å·²åˆ›å»º
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ __init__.py             âœ… å·²åˆ›å»º
â”‚   â”‚   â””â”€â”€ settings.py             # é…ç½®ç®¡ç†ç±»
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ __init__.py             âœ… å·²åˆ›å»º
â”‚   â”‚   â”œâ”€â”€ browser_manager.py     # æµè§ˆå™¨ç®¡ç†ï¼ˆè‡ªåŠ¨é©±åŠ¨æ›´æ–°ï¼‰
â”‚   â”‚   â”œâ”€â”€ login_handler.py       # ç™»å½•æµç¨‹
â”‚   â”‚   â”œâ”€â”€ reservation_handler.py # é¢„çº¦æµç¨‹ç¼–æ’
â”‚   â”‚   â”œâ”€â”€ slider_captcha.py      # æ»‘å—éªŒè¯ç å¤„ç† â­æ ¸å¿ƒ
â”‚   â”‚   â””â”€â”€ seat_query.py          # HTTPåº§ä½æŸ¥è¯¢ï¼ˆæ–°å¢ï¼‰
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ __init__.py             âœ… å·²åˆ›å»º
â”‚       â”œâ”€â”€ logger.py               # æ—¥å¿—å·¥å…·ï¼ˆä»…å¤±è´¥æ—¥å¿—ï¼‰
â”‚       â”œâ”€â”€ element_helper.py      # å…ƒç´ æ“ä½œåŠ©æ‰‹
â”‚       â””â”€â”€ date_helper.py         # æ—¥æœŸå¤„ç†å·¥å…·
â”œâ”€â”€ logs/                           âœ… å·²åˆ›å»ºï¼ˆæ—¥å¿—å­˜æ”¾ï¼‰
â”œâ”€â”€ errors/                         âœ… å·²åˆ›å»ºï¼ˆé”™è¯¯æˆªå›¾å­˜æ”¾ï¼‰
â”œâ”€â”€ main.py                         # ä¸»å…¥å£
â”œâ”€â”€ requirements.txt                âœ… å·²åˆ›å»º
â”œâ”€â”€ DEVELOPMENT_PLAN.md            âœ… å½“å‰æ–‡ä»¶
â””â”€â”€ README.md                       # ä½¿ç”¨è¯´æ˜ï¼ˆæœ€ååˆ›å»ºï¼‰
```

---

## ğŸ“… è¯¦ç»†å¼€å‘è®¡åˆ’ï¼ˆä¸¥æ ¼éµå®ˆè§„åˆ™ä¸‰ï¼šæ¯æ¬¡åªä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ï¼‰

### âœ… é˜¶æ®µ0ï¼šåŸºç¡€æ¶æ„ï¼ˆå·²å®Œæˆï¼‰
- [x] åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„
- [x] åˆ›å»ºç©ºçš„ `__init__.py` æ–‡ä»¶
- [x] åˆ›å»º `requirements.txt`
- [x] åˆ›å»ºå¼€å‘è®¡åˆ’æ–‡æ¡£

---

### ğŸ”§ é˜¶æ®µ1ï¼šå·¥å…·ç±»å¼€å‘ï¼ˆæŒ‰ä¾èµ–é¡ºåºï¼‰

#### æ­¥éª¤1ï¼šutils/logger.py
**åŠŸèƒ½**ï¼š
- é…ç½®æ—¥å¿—æ ¼å¼
- ä»…è®°å½•å¤±è´¥æ—¥å¿—ï¼ˆERRORçº§åˆ«ï¼‰
- ä¿å­˜é”™è¯¯æˆªå›¾å’ŒHTML
- æ”¯æŒå¤šè´¦æˆ·æ—¥å¿—åŒºåˆ†

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨Python loggingæ¨¡å—
- æ–‡ä»¶åæ ¼å¼ï¼š`error_{è´¦æˆ·å}_{é”™è¯¯ç±»å‹}_{æ—¶é—´æˆ³}.png`
- æ—¥å¿—æ ¼å¼ï¼š`%(asctime)s - %(name)s - %(levelname)s - %(message)s`

**é¢„è®¡æ—¶é—´**ï¼š30åˆ†é’Ÿ

---

#### æ­¥éª¤2ï¼šutils/date_helper.py
**åŠŸèƒ½**ï¼š
- è·å–åŒ—äº¬æ—¶é—´çš„æ˜å¤©æ—¥æœŸ
- ç”Ÿæˆç›®æ ‡æ—¥æœŸçš„XPathå®šä½å™¨
- å¤„ç†æ—¥æœŸæ ¼å¼è½¬æ¢

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨pytzå¤„ç†æ—¶åŒº
- æ”¯æŒè·¨æœˆã€è·¨å¹´è®¡ç®—
- ç”Ÿæˆå¤æ‚çš„æ—¥å†XPath

**é¢„è®¡æ—¶é—´**ï¼š30åˆ†é’Ÿ

---

#### æ­¥éª¤3ï¼šutils/element_helper.py
**åŠŸèƒ½**ï¼š
- ç»Ÿä¸€çš„å…ƒç´ ç­‰å¾…é€»è¾‘
- å®‰å…¨ç‚¹å‡»ï¼ˆå¸¦é‡è¯•æœºåˆ¶ï¼‰
- æ»šåŠ¨åˆ°å…ƒç´ 
- ç§»é™¤é®ç½©å±‚

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨WebDriverWait
- æ”¯æŒå¤šç§å®šä½æ–¹å¼ï¼ˆBy.XPATHç­‰ï¼‰
- å¼‚å¸¸å¤„ç†å’Œé‡è¯•æœºåˆ¶
- JavaScriptç‚¹å‡»ä½œä¸ºå¤‡é€‰

**é¢„è®¡æ—¶é—´**ï¼š1å°æ—¶

---

### âš™ï¸ é˜¶æ®µ2ï¼šé…ç½®ç®¡ç†

#### æ­¥éª¤4ï¼šconfig/settings.py
**åŠŸèƒ½**ï¼š
- è´¦æˆ·é…ç½®ï¼ˆç”¨æˆ·åã€å¯†ç ã€åº§ä½å·ï¼‰
- URLé…ç½®ï¼ˆç™»å½•URLã€é¢„çº¦URLï¼‰
- è·¯å¾„é…ç½®ï¼ˆé”™è¯¯ä¿å­˜è·¯å¾„ã€æ—¥å¿—è·¯å¾„ï¼‰
- æµè§ˆå™¨é…ç½®ï¼ˆé©±åŠ¨è·¯å¾„ã€é€‰é¡¹ï¼‰
- è¶…æ—¶é…ç½®ï¼ˆå…¨å±€è¶…æ—¶ã€å…ƒç´ ç­‰å¾…è¶…æ—¶ï¼‰

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨ç±»æ¥ç»„ç»‡é…ç½®
- æ”¯æŒå¤šè´¦æˆ·é…ç½®åˆ—è¡¨
- æ˜“äºä¿®æ”¹å’Œæ‰©å±•

**é¢„è®¡æ—¶é—´**ï¼š30åˆ†é’Ÿ

---

### ğŸš€ é˜¶æ®µ3ï¼šæ ¸å¿ƒåŠŸèƒ½å¼€å‘

#### æ­¥éª¤5ï¼šcore/browser_manager.py â­å…³é”®
**åŠŸèƒ½**ï¼š
- åˆå§‹åŒ–Edgeæµè§ˆå™¨
- ä½¿ç”¨webdriver-managerè‡ªåŠ¨ç®¡ç†é©±åŠ¨ç‰ˆæœ¬
- é…ç½®æµè§ˆå™¨é€‰é¡¹
- æµè§ˆå™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†

**å…³é”®ç‚¹**ï¼š
```python
from selenium import webdriver
from selenium.webdriver.edge.service import Service
from webdriver_manager.microsoft import EdgeChromiumDriverManager

# è‡ªåŠ¨ä¸‹è½½å¹¶ä½¿ç”¨æœ€æ–°é©±åŠ¨
service = Service(EdgeChromiumDriverManager().install())
driver = webdriver.Edge(service=service, options=options)
```

**è§£å†³é©±åŠ¨æ›´æ–°é—®é¢˜**ï¼š
- webdriver-managerä¼šè‡ªåŠ¨æ£€æµ‹æµè§ˆå™¨ç‰ˆæœ¬
- è‡ªåŠ¨ä¸‹è½½åŒ¹é…çš„é©±åŠ¨ç¨‹åº
- ç¼“å­˜é©±åŠ¨ï¼Œé¿å…é‡å¤ä¸‹è½½
- æ— éœ€æ‰‹åŠ¨æ›´æ–°é©±åŠ¨

**é¢„è®¡æ—¶é—´**ï¼š1å°æ—¶

---

#### æ­¥éª¤6ï¼šcore/slider_captcha.py â­â­æ ¸å¿ƒä¸­çš„æ ¸å¿ƒ
**åŠŸèƒ½**ï¼š
- è·å–æ»‘å—èƒŒæ™¯å›¾å’Œæ»‘å—å›¾
- ä½¿ç”¨ddddocrè¯†åˆ«æ»‘åŠ¨è·ç¦»
- ç”Ÿæˆæ¨¡æ‹Ÿäººå·¥çš„æ»‘åŠ¨è½¨è¿¹
- æ‰§è¡Œæ»‘å—æ‹–åŠ¨æ“ä½œ
- éªŒè¯ç»“æœåˆ¤æ–­

**å…³é”®æŠ€æœ¯**ï¼š
```python
import ddddocr
from selenium.webdriver.common.action_chains import ActionChains

# 1. åˆå§‹åŒ–è¯†åˆ«å™¨
slider_recognizer = ddddocr.DdddOcr(det=False, ocr=False)

# 2. è¯†åˆ«è·ç¦»
result = slider_recognizer.slide_match(slider_bytes, bg_bytes, simple_target=True)
distance = result['target'][0]

# 3. ç”Ÿæˆè½¨è¿¹ï¼ˆease-outç®—æ³•ï¼‰
def generate_track(distance):
    track = []
    current = 0
    mid = distance * 4 / 5
    t, v = 0.2, 0
    
    while current < distance:
        a = 2 if current < mid else -3
        v = v + a * t
        move = v * t + 0.5 * a * t * t
        current += move
        track.append(round(move))
    return track

# 4. æ‹–åŠ¨æ»‘å—
action = ActionChains(driver)
action.click_and_hold(slider_element).perform()
for move in track:
    action.move_by_offset(move, 0).perform()
    time.sleep(0.01)
action.release().perform()
```

**é¢„è®¡æ—¶é—´**ï¼š2å°æ—¶

---

#### æ­¥éª¤7ï¼šcore/seat_query.py ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰
**åŠŸèƒ½**ï¼š
- HTTPæ–¹å¼æŸ¥è¯¢å¯ç”¨åº§ä½åˆ—è¡¨
- é›†æˆåŸHTTPç‰ˆæœ¬çš„åº§ä½æŸ¥è¯¢é€»è¾‘
- æ”¯æŒåº§ä½çŠ¶æ€è¿‡æ»¤ï¼ˆå¯é¢„çº¦ã€å·²å ç”¨ï¼‰

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨aiohttpå¼‚æ­¥è¯·æ±‚
- å¤ç”¨åŸHTTPé¡¹ç›®çš„APIé€»è¾‘
- è¿”å›å¯ç”¨åº§ä½å·åˆ—è¡¨

**é¢„è®¡æ—¶é—´**ï¼š1å°æ—¶

---

#### æ­¥éª¤8ï¼šcore/login_handler.py
**åŠŸèƒ½**ï¼š
- æ‰§è¡Œç™»å½•æµç¨‹
- è¾“å…¥ç”¨æˆ·åå¯†ç 
- ç‚¹å‡»ç™»å½•æŒ‰é’®
- ç­‰å¾…ç™»å½•æˆåŠŸ

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨element_helperç»Ÿä¸€æ“ä½œ
- ç™»å½•çŠ¶æ€éªŒè¯
- å¼‚å¸¸å¤„ç†

**é¢„è®¡æ—¶é—´**ï¼š45åˆ†é’Ÿ

---

#### æ­¥éª¤9ï¼šcore/reservation_handler.py
**åŠŸèƒ½**ï¼š
- ç¼–æ’å®Œæ•´é¢„çº¦æµç¨‹
- è¿›å…¥åº”ç”¨ â†’ é€‰æ‹©æˆ¿é—´ â†’ é€‰æ‹©æ—¥æœŸ â†’ é€‰æ‹©åº§ä½ â†’ éªŒè¯ç  â†’ ç¡®è®¤
- è°ƒç”¨å„ä¸ªæ¨¡å—å®Œæˆé¢„çº¦

**å…³é”®ç‚¹**ï¼š
- æµç¨‹æ¸…æ™°ï¼Œæ­¥éª¤æ˜ç¡®
- æ¯æ­¥éƒ½æœ‰å¼‚å¸¸å¤„ç†
- æ”¯æŒå¤±è´¥é‡è¯•

**é¢„è®¡æ—¶é—´**ï¼š2å°æ—¶

---

### ğŸ”— é˜¶æ®µ4ï¼šä¸»ç¨‹åºé›†æˆ

#### æ­¥éª¤10ï¼šmain.py
**åŠŸèƒ½**ï¼š
- è¯»å–é…ç½®
- åˆ›å»ºåŒè´¦æˆ·å¹¶è¡Œçº¿ç¨‹
- å¯åŠ¨é¢„çº¦æµç¨‹
- å…¨å±€è¶…æ—¶æ§åˆ¶

**å…³é”®ç‚¹**ï¼š
```python
import threading

def run_account(account_config):
    # åˆå§‹åŒ–å„æ¨¡å—
    # æ‰§è¡Œé¢„çº¦æµç¨‹
    pass

# åŒè´¦æˆ·å¹¶è¡Œ
accounts = [account1_config, account2_config]
threads = []
for account in accounts:
    thread = threading.Thread(target=run_account, args=(account,))
    threads.append(thread)
    thread.start()

for thread in threads:
    thread.join()
```

**é¢„è®¡æ—¶é—´**ï¼š1å°æ—¶

---

### ğŸ“ é˜¶æ®µ5ï¼šæ–‡æ¡£ä¸æµ‹è¯•

#### æ­¥éª¤11ï¼šREADME.md
**å†…å®¹**ï¼š
- é¡¹ç›®ä»‹ç»
- åŠŸèƒ½ç‰¹æ€§
- å®‰è£…æ­¥éª¤
- ä½¿ç”¨è¯´æ˜
- é…ç½®è¯´æ˜
- å¸¸è§é—®é¢˜

**é¢„è®¡æ—¶é—´**ï¼š30åˆ†é’Ÿ

---

#### æ­¥éª¤12ï¼šæµ‹è¯•ä¸ä¼˜åŒ–
- å®Œæ•´æµç¨‹æµ‹è¯•
- Bugä¿®å¤
- æ€§èƒ½ä¼˜åŒ–
- ä»£ç Review

**é¢„è®¡æ—¶é—´**ï¼š2-3å°æ—¶

---

## ğŸ¯ å¼€å‘é‡ç‚¹

### 1. é©±åŠ¨è‡ªåŠ¨æ›´æ–°è§£å†³æ–¹æ¡ˆ â­â­â­
```python
from webdriver_manager.microsoft import EdgeChromiumDriverManager

# ç¬¬ä¸€æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½æœ€æ–°é©±åŠ¨
service = Service(EdgeChromiumDriverManager().install())

# åç»­è¿è¡Œä¼šä½¿ç”¨ç¼“å­˜çš„é©±åŠ¨
# å¦‚æœæµè§ˆå™¨æ›´æ–°ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä¸‹è½½æ–°é©±åŠ¨
```

**ä¼˜ç‚¹**ï¼š
- æ— éœ€æ‰‹åŠ¨ç®¡ç†é©±åŠ¨
- è‡ªåŠ¨é€‚é…æµè§ˆå™¨ç‰ˆæœ¬
- ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤ä¸‹è½½

---

### 2. æ»‘å—éªŒè¯ç è¯†åˆ« â­â­â­

**æŠ€æœ¯æ ˆ**ï¼š
- ddddocrï¼šè¯†åˆ«è·ç¦»ï¼ˆå‡†ç¡®ç‡95%+ï¼‰
- ease-outç®—æ³•ï¼šç”Ÿæˆäººå·¥è½¨è¿¹
- ActionChainsï¼šæ‹–åŠ¨æ“ä½œ

**éš¾ç‚¹**ï¼š
- è·å–æ»‘å—å›¾ç‰‡ï¼ˆå¯èƒ½æ˜¯Canvasæˆ–imgå…ƒç´ ï¼‰
- è½¨è¿¹è¦æ¨¡æ‹Ÿäººå·¥ï¼ˆåŠ é€Ÿâ†’å‡é€Ÿï¼‰
- éªŒè¯ç»“æœåˆ¤æ–­

---

### 3. HTTPåº§ä½æŸ¥è¯¢é›†æˆ â­â­

**æ–¹æ¡ˆ**ï¼š
- åœ¨é¢„çº¦å‰å…ˆHTTPæŸ¥è¯¢å¯ç”¨åº§ä½
- å¦‚æœé¦–é€‰åº§ä½ä¸å¯ç”¨ï¼Œè‡ªåŠ¨é€‰æ‹©å¤‡é€‰åº§ä½
- æé«˜é¢„çº¦æˆåŠŸç‡

---

## ğŸ“Š é¢„è®¡æ—¶é—´åˆ†é…

| é˜¶æ®µ | å†…å®¹ | é¢„è®¡æ—¶é—´ |
|------|------|----------|
| é˜¶æ®µ0 | åŸºç¡€æ¶æ„ | 30åˆ†é’Ÿï¼ˆå·²å®Œæˆï¼‰|
| é˜¶æ®µ1 | å·¥å…·ç±»å¼€å‘ | 2å°æ—¶ |
| é˜¶æ®µ2 | é…ç½®ç®¡ç† | 30åˆ†é’Ÿ |
| é˜¶æ®µ3 | æ ¸å¿ƒåŠŸèƒ½å¼€å‘ | 7å°æ—¶ |
| é˜¶æ®µ4 | ä¸»ç¨‹åºé›†æˆ | 1å°æ—¶ |
| é˜¶æ®µ5 | æ–‡æ¡£ä¸æµ‹è¯• | 3.5å°æ—¶ |
| **æ€»è®¡** | | **14.5å°æ—¶** |

---

## âœ… å¼€å‘è§„åˆ™éµå®ˆæ¸…å•

- [x] ç”¨æˆ·éœ€æ±‚ç¬¬ä¸€åŸåˆ™ï¼šä¸¥æ ¼æŒ‰ç”¨æˆ·éœ€æ±‚å¼€å‘
- [x] æ¨¡å—åŒ–å¼€å‘ï¼šåŠŸèƒ½æ‹†åˆ†ä¸ºç‹¬ç«‹æ¨¡å—
- [x] æ¯æ¬¡åªä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶ï¼šä¸¥æ ¼éµå®ˆ
- [x] ç®€æ´åŸåˆ™ï¼šæ— try-exceptï¼ˆé™¤éç”¨æˆ·è¦æ±‚ï¼‰
- [x] ä»£ç æ˜“è¯»æ€§ï¼šä¸­æ–‡æ³¨é‡Šï¼Œæ¸…æ™°é€»è¾‘
- [x] PEP8è§„èŒƒï¼š4ç©ºæ ¼ç¼©è¿›ï¼Œå‘½åè§„èŒƒ
- [x] Gitç‰ˆæœ¬ç®¡ç†ï¼šæ¯ä¸ªæ–‡ä»¶å®Œæˆåæäº¤

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**ç«‹å³å¼€å§‹æ­¥éª¤1**ï¼šå¼€å‘ `utils/logger.py`

è¯·ç¡®è®¤å¼€å‘è®¡åˆ’æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œæˆ‘å°†ä¸¥æ ¼æŒ‰æ­¤è®¡åˆ’æ‰§è¡Œï¼

